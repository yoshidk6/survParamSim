<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulation of parametric survival model — survparamsim • survParamSim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of parametric survival model — survparamsim"><meta property="og:description" content="The main function(s) to generate predicted survival using a model object
generated with survival::survreg() function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survParamSim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/survParamSim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/yoshidk6/survParamSim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation of parametric survival model</h1>
    <small class="dont-index">Source: <a href="https://github.com/yoshidk6/survParamSim/blob/HEAD/R/surv_param_sim.R" class="external-link"><code>R/surv_param_sim.R</code></a>, <a href="https://github.com/yoshidk6/survParamSim/blob/HEAD/R/surv_param_sim_resample.R" class="external-link"><code>R/surv_param_sim_resample.R</code></a></small>
    <div class="hidden name"><code>survparamsim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The main function(s) to generate predicted survival using a model object
generated with <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survival::survreg()</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">surv_param_sim</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  n.rep <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  censor.dur <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coef.var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na.warning <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">surv_param_sim_resample</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  n.rep <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  censor.dur <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n.resample</span>,</span>
<span>  strat.resample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coef.var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na.warning <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A <code>survreg</code> class object. Currently accept exponential,
lognormal, weibull, loglogistic, and gaussian distributions.</p></dd>


<dt>newdata</dt>
<dd><p>A required data frame for simulation that contain covariates in
the survival model. It is required even if this is the same as the one used
for <a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survival::survreg</a> function.</p>
<p>It also has to contain columns for survival information. These can be used
in <code><a href="plot_km_pi.html">plot_km_pi()</a></code> and <code><a href="plot_hr_pi.html">plot_hr_pi()</a></code> function as
observed data. Survival information can be dummy data, but time need to be
long enough so that simulated KM plot will be long enough for
<code><a href="plot_km_pi.html">plot_km_pi()</a></code> to draw simulated survival curves.</p>
<p>Subjects with NA for covariates in <code>survreg</code> model will be removed from
the simulation and subsequent plotting of observed data.</p></dd>


<dt>n.rep</dt>
<dd><p>An integer defining numbers of parametric bootstrap runs</p></dd>


<dt>censor.dur</dt>
<dd><p>A two elements vector specifying duration of events
censoring. Censoring time will be calculated with uniform distribution
between two numbers. No censoring will be applied if NULL is provided.</p></dd>


<dt>coef.var</dt>
<dd><p>Boolean specifying whether parametric bootstrap are
performed on survival model coefficients, based on variance-covariance
matrix. If FALSE, prediction interval only reflects inherent variability
from survival events.</p></dd>


<dt>na.warning</dt>
<dd><p>Boolean specifying whether warning will be shown if
<code>newdata</code> contain subjects with missing model variables.</p></dd>


<dt>n.resample</dt>
<dd><p>Number of subjects for resampled simulations.
If <code>strat.resample</code> is provided, this needs to be a vector of the length
equal to the number of categories in the stratification variable.</p></dd>


<dt>strat.resample</dt>
<dd><p>String specifying stratification variable for
resampling. Currently only one variable is allowed. If you need more than one,
create a new variable e.g. by <code><a href="https://rdrr.io/r/base/interaction.html" class="external-link">base::interaction()</a></code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>survparamsim</code> object that contains the original <code>survreg</code> class
object, newdata, and a data frame for predicted survival profiles with the
following columns:</p><ul><li><p><strong>event</strong>: event status, 0=censored, 1=event</p></li>
<li><p><strong>rep</strong>: ID for parametric bootstrap runs</p></li>
<li><p><strong>subj</strong>: ID for subjects in newdata (currently
original ID is not retained and subj is sequentially assigned
as 1:nrow(newdata))</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>surv_param_sim()</code> returns simulation using the provided subject
in <code>newdata</code> as it is, while <code>surv_param_sim_resample</code> perform
simulation based on resampled subjects from the dataset. The latter allows
more flexibility in terms of simulating future trials with different number
of subjects.
Note that with <code>surv_param_sim_resample()</code>, there is no
automatic safeguard to ensure certain number of subjects in each subgroup
or treatment groups, which may result in inconsistent number of subjects per
simulation or leads to Cox regression instability due to small N. Consider
using stratified resampling in this case.</p>
<p>Currently we have not tested whether this function work for a <code>survreg</code> model
with stratification variables.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit.lung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ph.ecog</span>, data <span class="op">=</span> <span class="va">lung</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">fit.lung</span></span></span>
<span class="r-in"><span><span class="va">n.rep</span>  <span class="op">&lt;-</span>  <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">newdata</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lung</span>, <span class="va">time</span>, <span class="va">status</span>, <span class="va">sex</span>, <span class="va">ph.ecog</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">censor.dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">surv_param_sim</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">n.rep</span>, <span class="va">censor.dur</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kenta Yoshida, Laurent Claret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

